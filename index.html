<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mein achtsamer Wochenkalender â€“ Version 15</title>

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f6f5f2;
  margin: 0;
  padding: 16px;
  color: #333;
}

h1 { text-align: center; margin-bottom: 8px; }
.subtitle { text-align:center; font-size:0.9em; color:#666; margin-bottom:24px; }

.week { display: flex; flex-direction: column; gap:16px; }

.day { background: #ffffff; border-radius:14px; padding:12px; box-shadow:0 2px 6px rgba(0,0,0,0.05); }
.day-title { font-weight:600; margin-bottom:10px; }
.columns { display:flex; gap:10px; }
.column { flex:1; border-radius:10px; padding:10px; min-height:40px; font-size:0.9em; color:#555; }
.left { background: #fff9c4; }   /* zartes Gelb */
.right { background: #e0f7fa; }  /* sanftes Blau */

/* Plus-Button */
#addButton {
  position: fixed; bottom:16px; right:16px; width:56px; height:56px;
  border-radius:50%; background:#2f7d7b; color:white; font-size:2rem;
  border:none; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.2);
}

/* Modal Popup */
#modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4); align-items:center; justify-content:center; padding:16px; }
#modal > div { background:white; border-radius:16px; padding:16px; width:100%; max-width:420px; display:flex; flex-direction:column; gap:12px; }

input, select, textarea, button { padding:8px; border-radius:8px; border:1px solid #ddd; font-size:0.9rem; }
#saveTask { background:#2f7d7b; color:white; border:none; }
#cancelTask { background:#ccc; flex:1; }
</style>
</head>

<body>

<h1>Mein achtsamer Wochenkalender</h1>
<div class="subtitle">Links das, was ich tue Â· rechts das, was ich im Blick behalte</div>

<div class="week" id="weekContainer">
  <!-- Wochentage werden per JS erstellt -->
</div>

<button id="addButton">+</button>

<div id="modal">
  <div>
    <h2>Aufgabe erstellen / bearbeiten</h2>

    <label>Titel</label>
    <input id="taskTitle" placeholder="z.â€¯B. Yoga, Kinderarzt" />

    <label>Tag</label>
    <select id="taskDay">
      <option value="0">Montag</option>
      <option value="1">Dienstag</option>
      <option value="2">Mittwoch</option>
      <option value="3">Donnerstag</option>
      <option value="4">Freitag</option>
      <option value="5">Samstag</option>
      <option value="6">Sonntag</option>
    </select>

    <label>Kategorie</label>
    <select id="taskCategory">
      <option value="selfcare">ğŸŒ SelbstfÃ¼rsorge</option>
      <option value="health">ğŸ’Š Gesundheit</option>
      <option value="household">ğŸ¡ Haushalt</option>
      <option value="finance">ğŸ’° Finanzen</option>
      <option value="creative">ğŸ¨ Kreatives</option>
      <option value="work">ğŸ’¼ Arbeit</option>
      <option value="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Familie</option>
      <option value="volunteer">ğŸ¤ Ehrenamt</option>
      <option value="friends">ğŸ«‚ Freunde</option>
      <option value="child-t">ğŸ§’ Kind T</option>
      <option value="child-n">ğŸ‘§ Kind N</option>
    </select>

    <label>Typ</label>
    <select id="taskType">
      <option value="todo">Mein Todo</option>
      <option value="info">Info / andere betrifft es</option>
    </select>

    <label>Private Notiz</label>
    <textarea id="taskNote" rows="3"></textarea>

    <label><input type="checkbox" id="taskDone"/> Erledigt</label>

    <div style="display:flex; gap:8px;">
      <button id="saveTask">Speichern</button>
      <button id="cancelTask">Abbrechen</button>
    </div>
  </div>
</div>

<script>
const weekdays = ['Montag','Dienstag','Mittwoch','Donnerstag','Freitag','Samstag','Sonntag'];
const weekContainer = document.getElementById('weekContainer');
const addButton = document.getElementById('addButton');
const modal = document.getElementById('modal');
const saveTask = document.getElementById('saveTask');
const cancelTask = document.getElementById('cancelTask');

let activeTask = null;
let draggedTask = null;
const columns = []; // Spalten fÃ¼r Drag & Drop

// Wochentage erstellen
weekdays.forEach((day, index) => {
  const dayDiv = document.createElement('div');
  dayDiv.className = 'day';
  dayDiv.dataset.day = index;
  dayDiv.innerHTML = `<div class="day-title">${day}</div>
                       <div class="columns">
                         <div class="column left"></div>
                         <div class="column right"></div>
                       </div>`;
  weekContainer.appendChild(dayDiv);

  columns.push(dayDiv.querySelector('.left'));
  columns.push(dayDiv.querySelector('.right'));
});

// Modal Ã¶ffnen / schlieÃŸen
addButton.onclick = () => openModal();
cancelTask.onclick = () => modal.style.display = 'none';

function openModal(task=null){
  activeTask = task;
  modal.style.display = 'flex';
  document.getElementById('taskTitle').value = task?.dataset.title || '';
  document.getElementById('taskCategory').value = task?.dataset.category || 'selfcare';
  document.getElementById('taskType').value = task?.dataset.type || 'todo';
  document.getElementById('taskNote').value = task?.dataset.note || '';
  document.getElementById('taskDone').checked = task?.dataset.done === "true";
  document.getElementById('taskDay').value = task?.dataset.day || 0;
}

saveTask.onclick = () => {
  const title = document.getElementById('taskTitle').value;
  const type = document.getElementById('taskType').value;
  const category = document.getElementById('taskCategory').value;
  const note = document.getElementById('taskNote').value;
  const done = document.getElementById('taskDone').checked;
  const day = parseInt(document.getElementById('taskDay').value);

  if(!title) return alert("Bitte einen Titel eingeben");

  let task = activeTask;
  if(!task){
    task = document.createElement('div');
    task.style.padding = '6px 8px';
    task.style.borderRadius = '8px';
    task.style.marginTop = '6px';
    task.style.cursor = 'pointer';
    task.draggable = true;
    task.ondragstart = e => { draggedTask = task; e.dataTransfer.effectAllowed='move'; };
    task.ondragend = () => draggedTask = null;
    task.onclick = () => openModal(task);
  }

  task.textContent = category.split(' ')[0] + ' ' + title; // Symbol + Text
  task.dataset.title = title;
  task.dataset.category = category;
  task.dataset.type = type;
  task.dataset.note = note;
  task.dataset.done = done;
  task.dataset.day = day;

  task.style.background = done ? '#cfcfcf' : '#ffe082';
  task.style.textDecoration = done ? 'line-through' : 'none';
  task.style.color = done ? '#777' : '#333';

  const column = type==='info' ? weekContainer.children[day].querySelector('.right')
                               : weekContainer.children[day].querySelector('.left');
  column.appendChild(task);
  reorderColumn(column);

  modal.style.display='none';
};

// Sortierung: erledigte Aufgaben nach unten
function reorderColumn(column){
  const tasks = [...column.children];
  const doneTasks = tasks.filter(t => t.dataset.done==='true');
  const openTasks = tasks.filter(t => t.dataset.done!=='true');
  [...openTasks, ...doneTasks].forEach(t => column.appendChild(t));
}

// Drag & Drop
columns.forEach(col => {
  col.ondragover = e => e.preventDefault();
  col.ondrop = e => {
    if(draggedTask){
      col.appendChild(draggedTask);
      reorderColumn(col);
    }
  };
});
</script>

</body>
</html>
